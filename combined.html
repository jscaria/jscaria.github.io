<html>
    <head>
        <title>OneDrive JavaScript Picker and Saver SDK sample</title>
		<script type="text/javascript" src="OneDrive.debug.js" id="onedrive-js" client-id="0000000048134837"></script>

		<script type="text/javascript">
		
		/*
		 * Response Functions
		 */
		function pickerSuccess(files) {
			// Handle returned file object(s)
			for(var i=0; i<files.length; i++) {
				var count = i+1;
				log("File #" + count);
				log("fileName: " + files[i].fileName);
				log("link: " + files[i].link);
				log("size: " + files[i].size + " bytes");
				log("linkType: " + files[i].linkType);
				log("thumbnail count: " + files[i].thumbnails.length);
				
				for(var j=0; j<files[i].thumbnails.length; j++) {
					log(files[i].thumbnails[j]);
				}
				
				log(""); // new line
			}	
		}
		
		function cancel() {
			log("User canceled");
		}
		
		function progress(p) {
			log("Uploaded " + p + "%.")
		}

		function saverSuccess() {
			log("File uploaded!");
		}
		
		function error(e) {
			log("There was an error saving your file.");
			log(e);
		}
		

		/*
		 * Picker options
		 */
		var bluePickerOptions = { 
			success: pickerSuccess,
			cancel: cancel,
			theme: "blue"
		};
		
		var whitePickerOptions = { 
			success: pickerSuccess,
			cancel: cancel,
			theme: "white"
		};
		
		var linkPickerOptions = { 
			success: pickerSuccess,
			cancel: cancel,
		};

		/*
		 * Saver options
		 */
		var blueSaverOptions = {
			file: "inputFile",
			success: saverSuccess,
			progress: progress,
			cancel: cancel,
			error: error,
			theme: "blue"
		}
		
		var whiteSaverOptions = {
			file: "inputFile",
			success: saverSuccess,
			progress: progress,
			cancel: cancel,
			error: error,
			theme: "white"
		}
		var linkSaverOptions = {
			file: "inputFile",
			success: saverSuccess,
			progress: progress,
			cancel: cancel,
			error: error
		}
		
		/*
		 * On Load
		 */		
		window.onload = function() {
			/*
			 * 1. Create button var
			 * 2. Add it to element
			 */
			
			var bluePickerButton = OneDrive.createOpenButton(bluePickerOptions);
			document.getElementById("bluePicker").appendChild(bluePickerButton); 

			var whitePickerButton = OneDrive.createOpenButton(whitePickerOptions);
			document.getElementById("whitePicker").appendChild(whitePickerButton); 
			
			var blueSaverButton = OneDrive.createSaveButton(blueSaverOptions);
			document.getElementById("blueSaver").appendChild(blueSaverButton); 
			
			var whiteSaverButton = OneDrive.createSaveButton(whiteSaverOptions);
			document.getElementById("whiteSaver").appendChild(whiteSaverButton); 			
		}		
			
		function launchOneDrivePicker() {
			OneDrive.open(linkPickerOptions);
		}
		
		function launchOneDriveSaver() {
			OneDrive.save(linkSaverOptions);
		}
		
		function log(message) {
			document.getElementById("console").value += message + "\n";
		}
		
		function updatePickerMultiSelect() {
			bluePickerOptions.multiSelect = document.getElementById("multiSelect").checked;
			whitePickerOptions.multiSelect = document.getElementById("multiSelect").checked;
			linkPickerOptions.multiSelect = document.getElementById("multiSelect").checked;
		}
		
		function updatePickerLinkType() {
			bluePickerOptions.linkType = document.querySelector('input[name="linkType"]:checked').value;
			whitePickerOptions.linkType = document.querySelector('input[name="linkType"]:checked').value;
			linkPickerOptions.linkType = document.querySelector('input[name="linkType"]:checked').value;
		}

		function updateSaverFileName() {
			var fileName = document.getElementById("fileName").value;
			if(fileName != "")
			{
				blueSaverOptions.fileName = fileName;
				whiteSaverOptions.fileName = fileName;
				linkSaverOptions.fileName = fileName;				
			}
		}		
	</script>
	</head>
	<body>
    <header>
        <h1>OneDrive picker and saver example</h1>
    </header>
	
	<div>
	<h3>OneDrive picker</h3>
	
	<table>
	    <tr>
	        <td>Options</td>
	        <td>
	                <input id="multiSelect" type="checkbox" name="multiSelect" onClick="javascript:updatePickerMultiSelect();" />
	                <label>Enable multiselect</label>
	        </td>
	    </tr>
	    <tr>
	        <td>Link type:</td>
	        <td>
	            <input id="linkType" type="radio" value="webViewLink" name="linkType" checked="checked" onClick="javascript:updatePickerLinkType();" />
	            <label>Web View Link</label>
	            <input id="linkType" type="radio" value="downloadLink" name="linkType" onClick="javascript:updatePickerLinkType();" />
	            <label>Download link</label>
	        </td>
	    </tr>
	    <tr>
	        <td>Blue Button:</td>
	        <td>
	        	<div id="bluePicker"></div>
	        </td>
	    </tr>
	    <tr>
	        <td>White Button:</td>	    
	        <td>
	        	<div id="whitePicker"></div>	  
	        </td>
	    </tr>
	    <tr>
	        <td>Custom Link:</td>	    
		<td>
			<div><a href="javascript:void(0);" onClick="javascript:launchOneDrivePicker();">Open from OneDrive</a></div>
		</td>
	    </tr>
	</table>
	


	
	</div>
	
	<div>
	<h3>OneDrive saver</h3>
	<table>
	    <tr>
	        <td>File:</td>
	        <td>
	                <input id="inputFile" name="file" type="file" />
	        </td>
	    </tr>
	    <tr>
	        <td>File name:</td>
	        <td>
	            <input id="fileName" type="textbox" name="fileName" onKeyUp="javascript:updateSaverFileName();" />
	            <label>Default: file name in the URL</label>
	        </td>
	    </tr>
	    <tr>
	        <td>Blue Button:</td>
	        <td>
			<div id="blueSaver"></div>
		</td>
	    </tr>			
	    <tr>
	        <td>White Button:</td>
	        <td>
			<div id="whiteSaver"></div>
		</td>
	    </tr>			
	    <tr>
	        <td>Custom Link:</td>
	        <td>
			<div><a href="javascript:void(0);" onClick="javascript:launchOneDriveSaver();">Save to OneDrive</a></div>
		</td>
	    </tr>

	</table>	
	</div>
	
	<div><br />
	<h4>Console</h4>
		<textarea id="console" style="margin: 0px; width: 1835px; height: 219px;"></textarea>
	</div>
	</body>
</html>
